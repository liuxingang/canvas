<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>6号线梳理机01</title>
    <style>
    body {
        background: #ddd;
    }
    
    #canvas_bg{
        background: url(./bg.png) no-repeat;
        background-size: cover;
        border: thin inset #aaaaaa;
        position: fixed;
        left:0;
        top:0;
        z-index: -10;
    }
    #canvas{
        position: fixed;
        top:0;
        left:0;
    }
    </style>
</head>

<body>

    <canvas id="canvas_bg" width="1200" height="560">not supported</canvas>
    <canvas id="canvas" width="1200" height="560">not supported</canvas>
    <script src="js/utils.js"></script>
    <script src="js/shape.js"></script>
    <script src="js/bg.js"></script>
    <script>
    window.onload = function() {
        bgLine();

        var canvas = document.getElementById('canvas'),
            context = canvas.getContext("2d"),
            arrows = [],
            arrowNums = 6,
            gear = new Gear(13,19),
            gear1 = new Gear(9,15);
            gear.x = 262;
            gear.y = 278;
            gear1.x = 289;
            gear1.y = 238;
            gear.speed =4;
            gear1.speed =-3;
            gear.angle =0;
            gear1.angle =90; 
        
        screeSize(canvas, context, 1200, 560);
            //中间两个小滚筒
        var leftRoller1 = new Roller(238,424,10),
            leftRoller2 = new Roller(268,434,10),
            //右侧滚筒
            roller0 = new Roller(376,470,10),
            roller1 = new Roller(444,470,10),
            roller2 = new Roller(466,440,12),
            roller3 = new Roller(508,442,23),
            roller4 = new Roller(546,388,36),
            roller4_1 = new Roller(500,402,7),
            roller4_2 = new Roller(496,382,10),
            roller4_3 = new Roller(506,363,7),
            roller4_4 = new Roller(518,346,10),
            roller4_5 = new Roller(538,341,7),
            roller4_6 = new Roller(558,339,10),
            roller4_7 = new Roller(582,356,7),
            roller4_8 = new Roller(598,374,14),
            roller5 = new Roller(612,434,36),
            roller6 = new Roller(720,372,76),
            roller6_1 = new Roller(626,384,10),
            roller6_2 = new Roller(629,362,7),
            roller6_3 = new Roller(632,345,7),
            roller6_4 = new Roller(638,329,7),
            roller6_5 = new Roller(648,310,10),
            roller6_6 = new Roller(666,299,7),
            roller6_7 = new Roller(682,285,10),
            roller6_8 = new Roller(702,282,7),
            roller6_9 = new Roller(722,277,10),
            roller6_10 = new Roller(752,286,7),
            roller6_11 = new Roller(772,292,10),
            roller7 = new Roller(826,434,36),
            roller7_1 = new Roller(884,414,18),
            roller7_2 = new Roller(926,420,18),
            roller7_3 = new Roller(954,436,9);
            roller7_4 = new Roller(976,426,10);
            roller7_5 = new Roller(968,456,10);
            roller8 = new Roller(826,310,36),
            roller8_1 = new Roller(884,288,18),
            roller8_2 = new Roller(926,294,18),
            roller8_3 = new Roller(954,310,9);
            roller8_4 = new Roller(976,300,10);
            roller8_5 = new Roller(954,332,10);

            //最右侧传送带
            roller9 = new Roller(926,354,7);
            roller9_1 = new Roller(1004,354,7);
            roller9_2 = new Roller(984,370,7);
            roller9_3 = new Roller(1060,458,7);
        
            //右下传送带
            roller10 = new Roller(926,478,7);
            roller10_1 = new Roller(1084,478,7);



            
            roller0.speed =10;
            roller0.angle =0;

            roller1.speed =10;
            roller1.angle =0;

            
            roller2.speed =-5;
            roller2.angle =0;

    
            roller3.speed =3;
            roller3.angle =0;

    
            roller4.speed =3;
            roller4.angle =0;

            roller4_1.speed =0;
            roller4_1.angle =0;

            roller4_2.speed =0;
            roller4_2.angle =0;

        
            roller4_3.speed =0;
            roller4_3.angle =0;

            roller4_4.speed =0;
            roller4_4.angle =0;

            roller4_5.speed =0;
            roller4_5.angle =0;

            roller4_6.speed =0;
            roller4_6.angle =0;

            roller4_7.speed =0;
            roller4_7.angle =0;

            roller4_8.speed =0;
            roller4_8.angle =0;

            roller5.speed =-1;
            roller5.angle =0;

            roller6.speed =1;
            roller6.angle =0;

            roller6_1.speed =0;
            roller6_1.angle =0;

            roller6_2.speed =0;
            roller6_2.angle =0;

        
            roller6_3.speed =0;
            roller6_3.angle =0;

        
            roller6_4.speed =0;
            roller6_4.angle =0;

    
            roller6_5.speed =8;
            roller6_5.angle =0;

            
            roller6_6.speed =0;
            roller6_6.angle =0;

        
            roller6_7.speed =8;
            roller6_7.angle =0;

        
            roller6_8.speed =0;
            roller6_8.angle =0;

        
            roller6_9.speed =8;
            roller6_9.angle =0;

            roller6_10.speed =0;
            roller6_10.angle =0;

            roller6_11.speed =8;
            roller6_11.angle =0;

            roller7.speed =5;
            roller7.angle =0;

        
            roller7_1.speed =5;
            roller7_1.angle =0;

            roller7_2.speed =5;
            roller7_2.angle =0;

        
            roller7_3.speed =5;
            roller7_3.angle =0;

            roller7_4.speed =8;
            roller7_4.angle =0;

            roller7_5.speed =0;
            roller7_5.angle =0;

            roller8.speed =5;
            roller8.angle =0;

            roller8_1.speed =5;
            roller8_1.angle =0;

            roller8_2.speed =5;
            roller8_2.angle =0;

            roller8_3.speed =0;
            roller8_3.angle =0;

            roller8_4.speed =8;
            roller8_4.angle =0;

            roller8_5.speed =0;
            roller8_5.angle =0;

            roller9.speed =10;
            roller9.angle =0;

            roller9_1.speed =10;
            roller9_1.angle =0;

            roller9_2.speed =10;
            roller9_2.angle =0;

            roller9_3.speed =10;
            roller9_3.angle =0;

            roller10.speed =10;
            roller10.angle =0;

            roller10_1.speed =10;
            roller10_1.angle =0;

            //直线动画  组件化
            var lineDots1 = new LineDots(270,50,800,30,200,'yellow');
                lineDots1.speedY = 0.01;

            //弧形动画 
            var circleDots1 = new CircleDots(266,276,100,28,6, 270,undefined,'yellow');
                circleDots1.speed = 0.01;

            var lineDots2 = new LineDots(250,300,400,20,140,'yellow');
                lineDots2.speedY = 0.01;
            //斜线运动
            var obliqueLineDots1 = new ObliqueLineDots(250,390,280,10,120,15);
                obliqueLineDots1.speed = 1;

            var lineDots3 = new LineDots(370,450,200,110,8,'white');
                lineDots3.speedX = 0.01;

            //右侧传送带水平传送
            var lineDots9 = new LineDots(946,344,100,66,2,'white');
                lineDots9.speedX = 0.01;
            //右侧传送带斜线传送
            var obliqueLineDots9 = new ObliqueLineDots(1010,-1560,200,62,66,6,'white');
                obliqueLineDots9.speed = 0.5;

            //右侧下传送带水平传送
            var lineDots10 = new LineDots(960,468,100,130,2,'white');
                lineDots10.speedX = 0.01;

            //对应roller3 
            var circleDots3 = new CircleDots(507,442,146,28,2, -90,250,'white');
                circleDots3.speed = -0.01;

            //对应roller4
            var circleDots4 = new CircleDots(546,388,200,42,2, 120,260,'white');
                circleDots4.speed = 0.01;

            //对应roller5
            var circleDots5 = new CircleDots(612,436,200,40,4, -70,310,'white');
                circleDots5.speed = -0.01;

            //对应roller6
            var circleDots6 = new CircleDots(718,376,400,86,4, 140,250,'white');
                circleDots6.speed = 0.01;

            //对应roller7
            var circleDots7 = new CircleDots(826,434,200,40,4, -20,250,'white');
                circleDots7.speed = -0.01;

            //对应roller7-1
            var circleDots7_1 = new CircleDots(884,414,200,22,4, 150,230,'white');
                circleDots7_1.speed = 0.01;
            //对应roller7-2
            var circleDots7_2 = new CircleDots(926,420,200,21,4, -20,230,'white');
                circleDots7_2.speed = -0.01;

            //对应roller8
            var circleDots8 = new CircleDots(826,310,200,40,4, -20,250,'white');
                circleDots8.speed = -0.01;

            //对应roller8-1
            var circleDots8_1 = new CircleDots(884,288,200,21,4, 150,230,'white');
                circleDots8_1.speed = 0.01;
            //对应roller8-2
            var circleDots8_2 = new CircleDots(926,294,200,21,4, -20,230,'white');
                circleDots8_2.speed = -0.01;

       

        for (var i = 0; i < arrowNums; i++) {
            var arrow = new Arrow();
            arrow.size = 1.5;
            arrows.push(arrow)
        }

        //arrow position and angle
        context.save();
        // context.translate(180, 120);
        arrows[0].x = 256;
        arrows[0].y = 138;
        arrows[0].rotation = -120 * Math.PI / 180;
        // arrows[0].draw(context);

        arrows[1].x = 240;
        arrows[1].y = 172;
        arrows[1].rotation = 78 * Math.PI / 180;
        arrows[1].draw(context);

        arrows[2].x = 204;
        arrows[2].y = 230;
        arrows[2].rotation = -90 * Math.PI / 180;
        arrows[2].draw(context);

        arrows[3].x = 204;
        arrows[3].y = 374;
        arrows[3].rotation = -90 * Math.PI / 180;
        arrows[3].draw(context);

        arrows[4].x = 244;
        arrows[4].y = 404;
        arrows[4].rotation = -120 * Math.PI / 180;
        arrows[4].draw(context);

        arrows[5].x = 280;
        arrows[5].y = 404;
        arrows[5].rotation = -60 * Math.PI / 180;
        arrows[5].draw(context);
        context.restore();


        function drawGear(gear){
            gear.angle +=gear.speed;
            gear.rotation = gear.angle * Math.PI/180;
                
            
            gear.draw(context);
        }

        function drawRoller(roller){
            roller.angle +=roller.speed;
            roller.rotation = roller.angle * Math.PI/180;
                
            
            roller.draw(context);
        }

        (function arrowFrame() {
            window.requestAnimationFrame(arrowFrame, canvas);
            context.clearRect(0, 0, canvas.width, canvas.height);

            var vx = -0.24,
                vy = -0.36;
            if(Math.sqrt((arrows[0].x -256)*(arrows[0].x -256)+(arrows[0].y -138)*(arrows[0].y -138)) > 54){
            
                arrows[0].x = 256;
                arrows[0].y = 138;
            }
            arrows[0].x += vx;
            arrows[0].y += vy;

            arrows[0].draw(context);
            //////
            var vx1 = 0.1,
                vy1 = 0.4;
            if(Math.sqrt((arrows[1].x -240)*(arrows[1].x -240)+(arrows[1].y -172)*(arrows[1].y -172)) > 50){
            
                arrows[1].x = 240;
                arrows[1].y = 172;
            }
            arrows[1].x += vx1;
            arrows[1].y += vy1;
            arrows[1].draw(context);
            //////////
            var vx2 = 0,
                vy2 = -0.5;
            if(Math.sqrt((arrows[2].x -204)*(arrows[2].x -204)+(arrows[2].y -230)*(arrows[2].y -230)) > 60){
            
                arrows[2].x = 204;
                arrows[2].y = 230;
            }
            arrows[2].x += vx2;
            arrows[2].y += vy2;
            arrows[2].draw(context);

            //////////
            var vx3 = 0,
                vy3 = -0.5;
            if(Math.sqrt((arrows[3].x -204)*(arrows[3].x -204)+(arrows[3].y -374)*(arrows[3].y -374)) > 60){
            
                arrows[3].x = 204;
                arrows[3].y = 374;
            }
            arrows[3].x += vx3;
            arrows[3].y += vy3;
            arrows[3].draw(context);

            //////////
            var vx4 = -0.2,
                vy4 = -0.3;
            if(Math.sqrt((arrows[4].x -244)*(arrows[4].x -244)+(arrows[4].y -404)*(arrows[4].y -404)) > 43){
            
                arrows[4].x = 244;
                arrows[4].y = 404;
            }
            arrows[4].x += vx4;
            arrows[4].y += vy4;
            arrows[4].draw(context);

            //////////
            var vx5 = 0.16,
                vy5 = -0.26;
            if(Math.sqrt((arrows[5].x -280)*(arrows[5].x -280)+(arrows[5].y -404)*(arrows[5].y -404)) > 37){
            
                arrows[5].x = 280;
                arrows[5].y = 404;
            }
            arrows[5].x += vx5;
            arrows[5].y += vy5;
            arrows[5].draw(context);



            //gear
            drawGear(gear);
            drawGear(gear1);

            //roller
            drawRoller(leftRoller1);
            drawRoller(leftRoller2);
            drawRoller(roller0);
            drawRoller(roller1);
            drawRoller(roller2);
            drawRoller(roller3);
            drawRoller(roller4);
            drawRoller(roller4_1);
            drawRoller(roller4_2);
            drawRoller(roller4_3);
            drawRoller(roller4_4);
            drawRoller(roller4_5);
            drawRoller(roller4_6);
            drawRoller(roller4_7);
            drawRoller(roller4_8);
            drawRoller(roller5);
            drawRoller(roller6);
            drawRoller(roller6_1);
            drawRoller(roller6_2);
            drawRoller(roller6_3);
            drawRoller(roller6_4);
            drawRoller(roller6_5);
            drawRoller(roller6_6);
            drawRoller(roller6_7);
            drawRoller(roller6_8);
            drawRoller(roller6_9);
            drawRoller(roller6_10);
            drawRoller(roller6_11);
            drawRoller(roller7);
            drawRoller(roller7_1);
            drawRoller(roller7_2);
            drawRoller(roller7_3);
            drawRoller(roller7_4);
            drawRoller(roller7_5);
            drawRoller(roller8);
            drawRoller(roller8_1);
            drawRoller(roller8_2);
            drawRoller(roller8_3);
            drawRoller(roller8_4);
            drawRoller(roller8_5);
            drawRoller(roller9);
            drawRoller(roller9_1);
            drawRoller(roller9_2);
            drawRoller(roller9_3);
            drawRoller(roller10);
            drawRoller(roller10_1);

            //直线粒子运动
            

            lineDots1.draw(context);
            circleDots1.draw(context);
            circleDots3.draw(context);
            circleDots4.draw(context);
            circleDots5.draw(context);
            circleDots6.draw(context);
            circleDots7.draw(context);
            circleDots7_1.draw(context);
            circleDots7_2.draw(context);
            circleDots8.draw(context);
            circleDots8_1.draw(context);
            circleDots8_2.draw(context);
            lineDots2.draw(context);
            lineDots3.draw(context);
            lineDots9.draw(context);
            lineDots10.draw(context);
            obliqueLineDots1.draw(context);
            obliqueLineDots9.draw(context);
            
        }())


    }
    </script>
</body>

</html>
